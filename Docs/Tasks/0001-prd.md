# 0001 ‚Äì PRD ‚Äì Week 1: Project Skeleton & First-Person Office Basics

## 1. Introduction / Overview

This PRD defines the requirements for **Week 1** of development for _Fallen Compass_.

**Status as of November 15, 2025:** Tasks 1-4 are complete. The project skeleton, core framework classes, first-person character, and office level with greybox geometry are fully implemented.

Week 1's goal is to create a **working Unreal Engine 5.7 C++ project skeleton** and a **first-person office prototype** that matches the GDD's "small office, first-person" perspective. At the end of Week 1, the developer should be able to:

- Launch the game into the **office level** with an **in-world main menu state**.
- See a **static camera focused on the desk** with UI overlay showing menu buttons.
- Transition from the main menu to **first-person gameplay** via "New Legacy" button.
- Move around the office in **first person** using WASD + mouse look.
- Interact with the **table** to focus the camera on it and return with ESC.
- Interact with the **door** to return to the main menu state.
- Use **ESC** to open a **pause menu** (from first person) with "Quit" and "Back to Main Menu".

This milestone establishes the technical foundation (project, base classes, Git) on which all later features will be built.

---

## 2. Goals

**Completed (Tasks 1-4):**

1. ‚úÖ Have a **clean UE 5.7 C++ project** set up with Git and basic branching strategy.
2. ‚úÖ Implement base game framework classes (`GameInstance`, `GameMode`, `PlayerController`) as custom, extendable types using the **FC** prefix.
3. ‚úÖ Implement a **first-person player pawn** with WASD movement and mouse look.
4. ‚úÖ Create the **office level (L_Office)** with greybox geometry, including an **interactable table** with CameraTargetPoint and an **interactable door**.

**In Progress (Task 5):** 5. Implement an **in-world Main Menu system** within the office level:

- Static camera focused on desk with UI overlay ("New Legacy", "Continue", "Load Save Game", "Options", "Quit").
- Smooth camera transition from menu state to first-person gameplay.
- Door interaction returns player to menu state.

6. Implement the **Office interaction flow**:
   - Interact with table ‚Üí camera pan/zoom to table.
   - ESC from table view ‚Üí return to first-person view.
   - ESC from first-person ‚Üí open pause menu with "Quit" and "Back to Main Menu".
   - Interact with door ‚Üí return to main menu state (camera transition + level reload).

---

## 3. User Stories

> ‚ÄúUser‚Äù = player; ‚ÄúDev‚Äù = solo developer.

1. **As a developer**, I want a clean UE 5.7 C++ project with source control, so that I can safely iterate without breaking my entire codebase. ‚úÖ **COMPLETE**
2. **As a developer**, I want custom base classes for GameInstance, GameMode, and PlayerController (with FC prefix), so that I can plug in later systems (office, Overworld, combat) without refactoring engine defaults. ‚úÖ **COMPLETE**
3. **As a player**, I want to start the game in the office with a **main menu state** showing a static camera view of the desk with UI overlay, so I can make choices before entering gameplay. üîÑ **IN PROGRESS**
4. **As a player**, I want to click "New Legacy" and smoothly transition from the menu camera to first-person gameplay, so the experience feels seamless and immersive. üîÑ **IN PROGRESS**
5. **As a player**, I want to move around the office with WASD and look around with the mouse, so that I can freely explore and inspect the environment. ‚úÖ **COMPLETE**
6. **As a player**, I want to interact with the **table** and have the camera pan/zoom onto it, so it feels like I am leaning in to inspect or use it. üîÑ **IN PROGRESS**
7. **As a player**, I want to press **ESC** while looking at the table to return to my normal first-person camera. üîÑ **IN PROGRESS**
8. **As a player**, I want to press **ESC** from first person to open a **pause menu** with options to continue, go back to the Main Menu, or quit the game. üîÑ **IN PROGRESS**
9. **As a player**, I want to interact with the **door** in the office to return to the main menu state with a smooth camera transition, so I can access save/load options or quit. üîÑ **IN PROGRESS**

---

## 4. Functional Requirements

### 4.1 Project & Tooling Setup

**FR-1** ‚Äì UE Project Creation

- The system **must** provide a UE 5.7 project using C++ as the primary code base.
- Project settings must be appropriate for:
  - **Windows PC** as the primary target.
  - **Linux/macOS** build targets **enabled**, but not actively tested in Week 1 (testing on Linux/macOS happens at the end of phases).

**FR-2** ‚Äì Source Control Setup

- The system **must** use Git for source control.
- A `.gitignore` file **must** be configured for Unreal Engine projects (intermediate, binaries, derived data, etc.).
- A basic branching convention (e.g., `main` + `feature/*`) should be documented in a short `README`.

**FR-3** ‚Äì Base Game Classes (FC Prefix)

- The project **must** define:
  - A custom `UGameInstance` subclass, e.g. `UFCGameInstance`, for global state later (expeditions, settings, save system).
  - A custom `AGameModeBase` subclass, e.g. `AFCGameMode`, used by the Office level.
  - A custom `APlayerController` subclass, e.g. `AFCPlayerController`, used by the Office level.
- The Office level **must** use the custom `AFCGameMode` and `AFCPlayerController`.

---

### 4.2 First-Person Controller, Office Level & Interactions

**FR-4** ‚Äì First-Person Pawn

- The system **must** implement a first-person character pawn, e.g. `AFCFirstPersonCharacter`, with:
  - WASD movement on a flat surface.
  - Mouse-controlled camera rotation (yaw/pitch).
  - Proper collision with walls/floor to avoid falling out of the level.

**FR-5** ‚Äì Input Mapping

- The project **must** set up input mappings for:
  - `MoveForward` / `MoveBackward`
  - `MoveRight` / `MoveLeft`
  - `Turn` (mouse X)
  - `LookUp` (mouse Y)
  - `Interact` (e.g. `E` or left-click while looking at an object)
  - `Pause` / `ESC`
- Default keybindings:
  - W/S/A/D for movement.
  - Mouse movement for look.
  - ESC for pause / back.
  - E (or another chosen key) for interaction.

**FR-6** ‚Äì Office Level (L_Office) ‚úÖ **COMPLETE**

- The system **must** include the "L_Office" level at `/Game/FC/World/Levels/L_Office.umap`:
  - A closed room (2000x2000x350 cm) with greybox geometry (floor, walls, ceiling) and proper collision.
  - Clear starting spawn point (PlayerStart) at room center.
  - BP_OfficeDesk blueprint with **CameraTargetPoint** scene component for camera targeting.
  - SM_Door placeholder mesh for exit interaction.
  - Comprehensive lighting setup: DirectionalLight, SkyLight, SkyAtmosphere, ExponentialHeightFog.
  - World Settings configured with FCGameMode override.
  - Various office props for visual reference and scale verification.

**FR-7** ‚Äì Game Flow: In-World Main Menu (Diegetic Menu System) üîÑ **IN PROGRESS**

- On game start, the system **must** load the **L_Office level** in a **main menu state**:
  - Spawn a static or slow-moving camera (MenuCamera) focused on the desk area.
  - No player character spawned or controlled initially.
  - Display a UMG-based menu widget (WBP_MainMenu) with:
    - Game logo (diegetic or overlay)
    - "New Legacy" button ‚Üí transitions to first-person gameplay
    - "Continue" button ‚Üí loads most recent save (disabled if no saves exist)
    - "Load Save Game" button ‚Üí opens save slot selector
    - "Options" button ‚Üí opens settings (placeholder for Week 1)
    - "Quit" button ‚Üí exits the application
  - Atmospheric details: dust motes, candle flicker, ambient office sounds.
- See detailed specification in `/Docs/Tasks/0005-MainMenu-Concept.md`.

**FR-8** ‚Äì Office Interactions: Door & Pause Menu üîÑ **IN PROGRESS**

- The Office level **must** support:
  - An **interactable door**:
    - When the player is in first-person view and activates **Interact** on the door, the game **must**:
      1. Fade to black (1-2 second transition)
      2. Reload L_Office level
      3. Initialize in main menu state (MenuCamera + WBP_MainMenu)
      4. Clear any gameplay state (player location, inventory, etc.)
  - A **pause menu** from first-person:
    - When the player is in **first-person camera mode** (not in table view) and presses **ESC**, open a pause menu.
    - The pause menu **must** contain:
      - "Resume" ‚Üí close the pause menu and return to the office.
      - "Back to Main Menu" ‚Üí trigger door interaction flow (fade + reload + menu state).
      - "Quit Game" ‚Üí exit the application.

**FR-9** ‚Äì Office Interactions: Table & Camera Behaviour

- The Office level **must** support:
  - An **interactable table**:
    - When the player is in first-person and uses **Interact** on the table, the camera must **pan/zoom to a table-focused view**.
      - This can be implemented as:
        - Switching to a table camera with an animated blend, or
        - Moving the current camera to a target transform.
    - While in the **table-focused view**:
      - Player movement is disabled.
      - Pressing **ESC** must:
        1. First, **return the camera to the first-person view** (normal `AFCFirstPersonCharacter` camera).
        2. Not immediately open the pause menu.
  - From **first-person view only**:
    - Pressing ESC opens the **pause menu** as described in FR-8.

---

## 5. Security Requirements

**SR-1** ‚Äì Secrets & Credentials

- No hard-coded secrets, API keys, or credentials should be committed to the repository.
- If any future services are configured, use environment variables or config files ignored by Git.

**SR-2** ‚Äì Repository Hygiene

- `.gitignore` must exclude:
  - `Binaries/`, `Intermediate/`, `DerivedDataCache/`, `Saved/` (except config).
- No large, auto-generated binary files should be manually committed unless strictly necessary.

**SR-3** ‚Äì Local-Only Access

- The project at this stage is **local-only**.
- No networked features, online services, or user account systems should be implemented in Week 1.

**SR-4** ‚Äì Engine & Plugin Trust

- Only official Unreal Engine 5.7 and trusted marketplace plugins are allowed.
- No random third-party binaries or .dlls from unverified sources should be added.

---

## 6. Non-Goals (Out of Scope for Week 1)

- No **map table UI** yet (no world map, no route planning).
- No **Overworld gameplay**, no convoy, no Top-Down camera.
- No **camp scenes, combat, or route planning**.
- No **save/load system** beyond default engine behavior.
- No **final art, materials, or lighting** ‚Äì Week 1 is purely functional (greybox).
- No **complex options menus** (graphics, keybindings) beyond UE defaults.

---

## 7. Design Considerations

- **Naming conventions**

  - All custom project classes follow the **FC prefix**:
    - `UFCGameInstance`, `AFCGameMode`, `AFCPlayerController`, `AFCFirstPersonCharacter`, etc.

- **Menu approach**

  - Use an **in-world main menu within L_Office**:
    - Main menu is a **game state** within the office level, not a separate level.
    - MenuCamera provides static/slow-moving view of the desk.
    - WBP_MainMenu UI overlay shows buttons for New Legacy, Continue, Load, Options, Quit.
    - "New Legacy" transitions from menu state to gameplay state with camera blend.
    - Door interaction returns to menu state via level reload (to clear gameplay state).
    - Pause menu from gameplay is a UI overlay, _not_ a state change.
  - Benefits: immersive, no loading screen on game start, atmospheric introduction.

- **Camera behaviour**

  - Menu camera:
    - Static or slow-moving camera focused on desk area (300-500 units distance).
    - FOV 60-75¬∞ for cinematic feel.
    - Optional subtle breathing/rotation for visual interest.
  - Menu ‚Üí Gameplay transition:
    - Smooth camera blend (2 seconds, Cubic easing) from MenuCamera to FirstPersonCamera.
    - Player spawned/activated during blend.
  - Table interaction:
    - Feel like the player "leans in" to the table: smooth camera pan and zoom.
    - ESC acts as "step back" to first-person.
  - Only in first-person camera mode should ESC open the **pause menu**.

- **Office layout**
  - The Office room should:
    - Convey a small, contained space.
    - Leave enough room to walk and turn without motion sickness.
    - Have clear visual placement for the table and door so the interactions are discoverable.

---

## 8. Technical Considerations

- **Engine Version:** Unreal Engine **5.7** (C++ project).
- **Target Platforms:**
  - **Windows PC** ‚Äì primary development and testing target during Week 1.
  - **Linux/macOS** ‚Äì enabled in project settings, but tested **only at the end of phases**, not weekly.
- **Code Structure:**

  - Base classes in a core module:
    - `UFCGameInstance`
    - `AFCGameMode`
    - `AFCPlayerController`
    - `AFCFirstPersonCharacter`
  - Office interaction logic (table, door, camera, pause menu) implemented cleanly in C++ and/or Blueprints associated with office level and player controller.

- **Blueprint vs C++:**
  - Core framework in **C++**.
  - Interactions, camera transitions, and pause menu may be implemented using Blueprints/UMG for faster iteration.

---

## 9. Success Metrics

Week 1 is successful if all of the following are true:

1. The project **builds and runs** without errors on Windows.
2. On start, the game shows a **Main Menu level** with:
   - ‚ÄúStart Game‚Äù button that loads the Office level and spawns `AFCFirstPersonCharacter`.
   - ‚ÄúQuit Game‚Äù button that exits the application.
3. In the Office level:
   - The player can move with WASD and look with the mouse.
   - The player can interact with the **table**:
     - Camera pans/zooms into a table-focused view.
     - Pressing ESC returns camera to first-person.
   - The player can press ESC while in **first-person**:
     - A pause menu appears with ‚ÄúResume‚Äù, ‚ÄúBack to Main Menu‚Äù, ‚ÄúQuit Game‚Äù.
   - The player can interact with the **door**:
     - The game returns to the Main Menu level.
4. From the Main Menu, ‚ÄúQuit Game‚Äù exits the app.
5. All code and project files are tracked in Git, with:
   - An initial commit.
   - A clean working tree (no unexpected untracked UE junk).

---

## 10. Open Questions

(For later phases; none block Week 1 completion now.)

1. Final visual style and composition of the office (current greybox is functional).
2. Logo design and placement for main menu (diegetic object vs. UI overlay).
3. Table camera view will eventually host world map UI and route planning (Week 2+).
4. Save game data structure and persistent world state (basic slots in Task 5, full system later).
5. Options menu content (graphics, audio, keybindings - placeholder in Task 5).

## 11. References

- **Task Breakdown:** `/Docs/Tasks/0001-tasks.md` - Detailed implementation steps for Tasks 1-7
- **Main Menu Concept:** `/Docs/Tasks/0005-MainMenu-Concept.md` - Technical specification for in-world menu system (Task 5)
- **GDD:** `/Docs/Fallen_Compass_GDD_v0.2.md` - Game design document with overall vision and mechanics
- **DRM:** `/Docs/Fallen_Compass_DRM.md` - Development roadmap for Phases 1-3
